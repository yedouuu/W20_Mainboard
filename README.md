# 项目介绍文档

## 一、项目基本信息

* **项目名称**：WL\_W20\_Mainboard
* **项目类型**：嵌入式主控软件工程
* **项目用途**：立式单口点钞机主控程序开发
* **项目依赖**：卓目 GL20 图像识别板
* **开发团队**：XXX 嵌入式开发组
* **当前版本**：v0.0.0
* **创建日期**：2025-07-16
* **文档作者**：Linye

## 二、项目背景

本项目旨在开发一款自研立式单口点钞机主控程序，适配市场主流图像识别模组——卓目 GL20 图像板。
项目将基于 AT32F403A MCU 实现多任务管理、图像数据交互、UI界面驱动、计数与鉴伪功能等核心控制逻辑。

## 三、项目目标

本项目通过嵌入式主控软件开发，达成以下目标：

1. 构建稳定、可扩展的嵌入式系统软件框架；
2. 实现与图像板的串口协议通信（命令发送、识别结果接收）；
3. 搭建点钞仿真 UI，用于测试及展示；
4. 实现纸币张数计数逻辑；
5. 支持伪币检测、污损识别等扩展功能；
6. 预留拓展接口（如蓝牙、USB 升级等）以支持未来产品迭代。

## 四、技术架构

* **主控芯片**：AT32F403A
* **操作系统**：FreeRTOS
* **界面驱动**：LVGL 图形库 + 8080接口
* **通信接口**：
  * UART：与图像板通信
  * USB/UART：用于PC调试和固件升级
* **计数方式**：红外传感器中断计数，结合图像识别去重
* **存储方式**：EEPROM 配置存储（视芯片资源）

## 五、开发计划

| 阶段  | 时间周期 | 任务目标                             |
| --- | ---- | -------------------------------- |
| 阶段一 | 第1-2周 | 项目框架搭建，FreeRTOS初始化，任务划分，串口通信基础实现 |
| 阶段二 | 第3-4周 | UI仿真界面实现，LCD驱动，按钮输入处理            |
| 阶段三 | 第5-6周 | 点钞计数功能联调，与图像板交互调试                |
| 阶段四 | 第7-8周 | 鉴伪功能集成与联调，BUG修复与性能优化             |
| 阶段五 | 第9-10周 | 测试验证，编写用户文档，版本发布（v1.0.0）         |

## 六、主要模块说明

* **系统框架**：基于FreeRTOS构建，采用任务分层结构，方便后期维护与扩展。
* **UI模块**：使用LVGL，支持触摸事件、动态切换界面、字体图标自定义。
* **点钞控制模块**：通过红外传感器中断计数 + 图像识别去重，实现高精度计数。
* **通信模块**：与图像板通信协议自定义，采用帧头帧尾、CRC校验结构，具备重发机制。
* **日志与调试**：支持串口日志打印，错误码系统，便于问题定位。
* **配置存储**：关键参数存储于Flash或EEPROM中，具备掉电保持能力。

## 七、版本控制

* **v0.1.0**：框架雏形，完成FreeRTOS调度、串口通信初步测试
* **v0.5.0**：完成LCD驱动、LVGL UI界面初版
* **v0.9.0**：集成图像板通信与点钞逻辑，具备基本功能
* **v1.0.0**：完成全部功能，进入测试阶段

## 八、未来展望

* 支持新型号图像板接入
* 接入蓝牙模块
* 打通远程OTA升级机制

## 九、附录

* [通信协议文档](./docs/uart_protocol.md)
* [UI设计原型图](./docs/ui_mockup.png)
* [硬件连接图](./docs/hw_connection.pdf)
